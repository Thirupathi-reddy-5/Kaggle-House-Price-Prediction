# -*- coding: utf-8 -*-
"""Kaggle House Price EDA.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1zVpPW-91EkgKJZcPNAosyRHPtIFRKJh8
"""

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

"""Reading the Dataset

"""

df=pd.read_csv("/content/Kaggle House Price.csv")

"""# **To display all the columns in the data set**"""

pd.set_option('display.max_columns',None)

df.head()

df.isnull().sum()

df.shape

df.info()

[col for col in df.columns if df[col].isnull().sum()>0]

Date_cols=[col for col in df.columns if 'Year' in col or  'Yr' in col]

Date_cols

Numerical_features=[col for col in df.columns if df[col].dtype!='O' and col not in Date_cols]

Numerical_features

len(Numerical_features)

Categorical_features=[col for col in df.columns if df[col].dtype=='O']

Categorical_features

len(Categorical_features)

discrete_numeric_features=[col for col in Numerical_features if df[col].dtype=='int64' ]

discrete_numeric_features

Continuous_numeric_features=[col for col in Numerical_features if df[col].dtype=='float64' ]

Continuous_numeric_features



"""#Kaggle House price Dataset

# EXPLORATORY DATA ANALYSIS
"""

import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns

"""# Reading the Dataset"""

df=pd.read_csv("/content/Kaggle House Price.csv")

"""Set_option is a function in the pandas library which is used to change how the data frame is displayed that is it is used to change the global display settings

display.max_columns this is the option which we are setting which is used to display the columns

None indicates that there is no limit to display and display all the available columns
"""

pd.set_option('display.max_columns',None)

"""To display top 5 rows of the dat set"""

df.head()

"""To display the shape of the data set"""

df.shape

"""To get the features having the null values and store them in Null_features"""

Null_features=[feature  for  feature in df.columns if df[feature].isnull().sum()>0]

Null_features

"""Here we are looping through the Null_features list and printing the percentage of null values in each feature and rounding off them to 2 decimals"""

for feature  in Null_features:
  print(feature,np.round(df[feature].isnull().mean()*100,2))

"""Looping through all the features in Null_values and filling the null values with 1 and others with 0 .

Misingness may carry some information so inorder to fin=d the relation between these missing ness and dependent features.

Here we are making a fresh copy of data frame into data to keep our original data clean
"""

data=df.copy()
for feature in Null_features:
  data[feature]=np.where(data[feature].isnull(),1,0)

"""Looping through all the features and plotting them by grouping them with sale price column

data.groupby(feature)['SalePrice'].mean() -- # It will compute the mean sale price for both the categories

plot(kind='bar') -- This will plot a bar graph for both categories
"""

for feature in Null_features:
  plt.figure(figsize=(6,4))
  data.groupby(feature)['SalePrice'].mean().plot(kind='bar')
  plt.title(f"graph for missing vs Non missing values of  {feature} ")
  plt.xlabel(feature)
  plt.ylabel("Sale Price ")
  plt.show()

"""In the above code we have grouped them based on mean sale price but that may have outliers which will impact our data so it is better to group them based on median"""

for feature in Null_features:
  plt.figure(figsize=(6,4))
  data.groupby(feature)['SalePrice'].median().plot(kind='bar')
  plt.title(f"graph for missing vs Non missing values of  {feature} ")
  plt.xlabel(feature)
  plt.ylabel("Sale Price ")
  plt.show()

"""features having Years"""

Year_features=[feature for feature in df.columns if 'Yr' in feature or 'Year' in feature]

Year_features

"""Iterating through the year features and finding printing the unique() values"""

for i in Year_features:
  print(i,df[i].unique())

"""As YrSold feature has only 5 categories lets plot it using bar graph"""

plt.bar(df['YrSold'],df['SalePrice'])

"""Plotting YeraBuilt with sale price"""

plt.bar(df['YearBuilt'],df['SalePrice'])

"""As there are many unique categories in the years columns lets group them based on their decades.

(data1[feature]//10)*10) this will take the year values and round off that to decade that is 1963 will be rounded to 1960 decade

Grouping years  based on decades and plotting them with the  sale price
"""

data1=df.copy()
for feature in Year_features:
  if feature!='YrSold':
    data1.groupby((data1[feature]//10)*10)['SalePrice'].median().plot(kind='bar')
    plt.title(f"Price distribution for decades of {feature}")
    plt.xlabel(feature)
    plt.ylabel("Sale Price")
    plt.show()

data1.head()

"""Here except the sale price we are finding the age of the particular feature by subtracting  the feature with year sold column

So we can figure out how the price is distribting based on the age of that particular feature
"""

for feature in Year_features:
  if feature!='YrSold':
    data1[feature]=data1['YrSold']-data1[feature]
    plt.scatter(data1[feature],data1['SalePrice'])
    plt.xlabel(feature)
    plt.ylabel("Sale Price")
    plt.show()

"""Filtering all the numeric features and which are not in Year_features"""

Numeric_features=[feature for feature in df.columns if df[feature].dtype!='O' and feature not in Year_features ]

len(Numeric_features)

# Discrete_Numeric_features=[feature for feature in Numeric_features if df[feature].dtype==('int64') and feature not in Year_features]

# we should not use this because while plotting the data some of the column may have many discrete data points which is difficult to plot

"""Filtering the discrete features based on the length of the categories"""

Discrete_Numeric_features=[feature for feature in Numeric_features if df[feature].dtype=="int64" and df[feature].nunique()<20]

len(Discrete_Numeric_features)

"""Plotting the discrete numeric features with he sale price"""

data2=df.copy()
for feature in Discrete_Numeric_features:
  fig=plt.figure(figsize=(6,4))
  data2.groupby(feature)['SalePrice'].median().plot(kind='bar')
  plt.title(f"Price distribution for {feature}")
  plt.xlabel(feature)
  plt.ylabel("Sale Price")
  plt.show()

"""filtering the remaining features as continuous numeric features as they have many unique values"""

Continuous_numeric_features=[feature for feature in Numeric_features if feature not in Discrete_Numeric_features]

len(Continuous_numeric_features)

"""Plotting the continuous numeric values with the help of histograms to find the distribyution of these continuous variables"""

data2=df.copy()
for feature in Continuous_numeric_features:
  if feature!='Id':
    data2[feature].hist(bins=20,figsize=(6,4))
    plt.title(f"Price distribution for {feature}")
    plt.xlabel(feature)
    plt.ylabel("Count")
    plt.show()

"""# Applying the logarithmic transformation to the continuous variables"""

dataset=df.copy()
dataset['SalePrice']=np.log(dataset['SalePrice'])
for feature in Continuous_numeric_features:
    if  (dataset[feature]<=0).any():
      pass
    else:
      dataset[feature]=np.log(dataset[feature])
      plt.scatter(dataset[feature],dataset['SalePrice'])
      plt.xlabel(feature)
      plt.ylabel("Sale Price")
      plt.title(f"Price distribution for {feature}")
      plt.show()

dataset1=df.copy()
for feature in Continuous_numeric_features:
    if 0 in dataset[feature].unique():
      pass
    else:
      dataset1[feature]=np.log(dataset1[feature])
      dataset1[feature].hist(bins=20,figsize=(6,4))
      plt.title(f"Price distribution for {feature}")
      plt.xlabel(feature)
      plt.ylabel("Count")
      plt.show()













"""lets check the categorical variables and their relationship with sale price"""

Categorical_features=[feature for feature in df.columns if df[feature].dtype=='O']

len(Categorical_features)

for feature in Categorical_features:
  fig=plt.figure(figsize=(6,4))
  data2.groupby(feature)['SalePrice'].median().plot(kind='bar')
  plt.xlabel(feature)
  plt.ylabel("Sale Price")
  plt.title(f"Price distribution for {feature}")
  plt.show()

